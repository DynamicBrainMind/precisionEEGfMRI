rm(list=ls())
library(tidyverse)
library(ggpubr)
library(here)
library(fs)
library(arrow)
library(scales)
library(RColorBrewer)
setwd(path(here(), 'analysis'))
root <- path('scripts/sandbox/timeseries')
# Show EEG spectrum with fMRI
eeg <- read.csv(path(root, 'eeg_spectrum.csv'))
eeg <- eeg %>%
mutate(sample = 1:(nrow(.))) %>%
mutate(time = sample / 250) %>%
gather(freq, power, starts_with('X')) %>%
mutate(freq = as.integer(str_replace(freq, 'X', '')))
fmri <- read_feather('data/merged_data.feather')
fmri <- fmri %>%
select(subject:dmn_b) %>%
filter(subject == 'sub-006', session == 'ses-001', run == 'run-002', tr <= 15) %>%
mutate(time = tr * 2) %>%
select(time, dmn, dan) %>%
gather(region, bold, dmn, dan)
d <- left_join(eeg, fmri)
p1 <- eeg %>%
ggplot(aes(x = time, y = freq)) +
geom_raster(aes(fill = power)) +
scale_fill_gradientn(colors = rev(brewer.pal(11, 'RdBu'))) +
labs(
x = 'Time (s)',
y = 'Frequency (Hz)'
) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
legend.position = 'none',
text = element_text(size = 16))
rd <- brewer.pal(11, 'RdBu')[3]
bu <- brewer.pal(11, 'RdBu')[9]
p2 <- fmri %>%
mutate(region = toupper(region)) %>%
ggplot(aes(x = time, y = bold)) +
geom_point(size = 1.5, aes(color = region)) +
geom_line(aes(color = region)) +
labs(
x = 'Time (s)',
y = 'BOLD',
color = ''
) +
xlim(0, 30) +
scale_color_manual(values = c('DAN' = bu, 'DMN' = rd)) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
legend.position = c(.05, .6),
text = element_text(size = 16))
g <- ggarrange(p2, p1, nrow = 2)
g
# Screens
ggsave(plot = g, filename = path(root, 'eeg_fmri_timeseries.png'),
height = 1080, width = 1920, units = 'px', dpi = 120)
min(fmri$bold)
p2 <- fmri %>%
mutate(region = toupper(region)) %>%
ggplot(aes(x = time, y = bold)) +
geom_point(size = 1.5, aes(color = region)) +
geom_line(aes(color = region)) +
labs(
x = 'Time (s)',
y = 'BOLD',
color = ''
) +
xlim(0, 30) +
ylim(-45, 60)
scale_color_manual(values = c('DAN' = bu, 'DMN' = rd)) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
legend.position = c(.05, .6),
text = element_text(size = 16))
p2 <- fmri %>%
mutate(region = toupper(region)) %>%
ggplot(aes(x = time, y = bold)) +
geom_point(size = 1.5, aes(color = region)) +
geom_line(aes(color = region)) +
labs(
x = 'Time (s)',
y = 'BOLD',
color = ''
) +
xlim(0, 30) +
ylim(-45, 60) +
scale_color_manual(values = c('DAN' = bu, 'DMN' = rd)) +
theme_bw() +
theme(axis.ticks = element_blank(),
panel.grid = element_blank(),
legend.position = c(.05, .6),
text = element_text(size = 16))
g <- ggarrange(p2, p1, nrow = 2)
# Screens
ggsave(plot = g, filename = path(root, 'eeg_fmri_timeseries.png'),
height = 1080, width = 1920, units = 'px', dpi = 120)
fmri <- read_feather('data/merged_data.feather')
ncol(fmri)
nrow(fmri)
fmri[1:20, 1:10]
q()
